import process from 'node:process' // –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
import { defineConfig, devices } from '@playwright/test' // –ë–∞–∑–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Playwright

/**
 * –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Playwright –¥–ª—è E2E-—Ç–µ—Å—Ç–æ–≤
 */
export default defineConfig({
  // –ü–∞–ø–∫–∞ —Å —Ç–µ—Å—Ç–∞–º–∏
  testDir: './e2e',
  
  // –¢–∞–π–º–∞—É—Ç—ã
  timeout: 30 * 1000, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ (30 —Å–µ–∫)
  expect: {
    timeout: 5000, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ expect (5 —Å–µ–∫)
  },

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è CI-–æ–∫—Ä—É–∂–µ–Ω–∏—è
  forbidOnly: !!process.env.CI, // –ó–∞–ø—Ä–µ—Ç test.only –Ω–∞ CI
  retries: process.env.CI ? 2 : 0, // –ü–æ–≤—Ç–æ—Ä—ã —Ç–æ–ª—å–∫–æ –Ω–∞ CI
  workers: process.env.CI ? 1 : undefined, // –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º (–Ω–∞ CI - 1 worker)

  // –û—Ç—á—ë—Ç–Ω–æ—Å—Ç—å
  reporter: 'html', // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML-–æ—Ç—á—ë—Ç–∞

  // –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  use: {
    actionTimeout: 0, // –¢–∞–π–º–∞—É—Ç –¥–µ–π—Å—Ç–≤–∏–π (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
    baseURL: process.env.CI ? 'http://localhost:4173' : 'http://localhost:5173', // –ë–∞–∑–æ–≤—ã–π URL
    trace: 'on-first-retry', // –ó–∞–ø–∏—Å—å —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–µ
    headless: !!process.env.CI, // –ë–µ–∑ GUI —Ç–æ–ª—å–∫–æ –Ω–∞ CI
  },

  // –ë—Ä–∞—É–∑–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] },
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] },
    },
    // –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ –±—Ä–µ–Ω–¥–æ–≤—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
  ],

  // –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–æ–≤
  webServer: {
    command: process.env.CI ? 'npm run preview' : 'npm run dev', // –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞
    port: process.env.CI ? 4173 : 5173, // –ü–æ—Ä—Ç
    reuseExistingServer: !process.env.CI, // –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
  },
})

// ===================
// –®–ü–ê–†–ì–ê–õ–ö–ê PLAYWRIGHT
// ===================
/*
1. –û–°–ù–û–í–ù–´–ï –ö–û–ú–ê–ù–î–´:
   ‚Ä¢ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤: npx playwright test
   ‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞: npx playwright show-report
   ‚Ä¢ –ó–∞–ø—É—Å–∫ –≤ UI-—Ä–µ–∂–∏–º–µ: npx playwright test --ui
   ‚Ä¢ –î–µ–±–∞–≥: npx playwright test --debug

2. –ö–õ–Æ–ß–ï–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò:
   ‚Ä¢ testDir - –ø–∞–ø–∫–∞ —Å —Ç–µ—Å—Ç–∞–º–∏
   ‚Ä¢ timeout - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞
   ‚Ä¢ projects - —Å–ø–∏—Å–æ–∫ –±—Ä–∞—É–∑–µ—Ä–æ–≤/—É—Å—Ç—Ä–æ–π—Å—Ç–≤
   ‚Ä¢ webServer - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

3. –ü–û–ü–£–õ–Ø–†–ù–´–ï –î–û–ü–û–õ–ù–ï–ù–ò–Ø:
   ‚Ä¢ –í–∏–¥–µ–æ–∑–∞–ø–∏—Å—å —Ç–µ—Å—Ç–æ–≤: 
     use: { video: 'on' }
   ‚Ä¢ –°–∫—Ä–∏–Ω—à–æ—Ç—ã –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏:
     use: { screenshot: 'only-on-failure' }
   ‚Ä¢ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ö—É–∫–∏:
     globalSetup: './global-setup.ts',
     globalTeardown: './global-teardown.ts'

4. –ü–†–ò–ú–ï–† –¢–ï–°–¢–ê:
   import { test, expect } from '@playwright/test'
   
   test('basic test', async ({ page }) => {
     await page.goto('/')
     await expect(page).toHaveTitle('My App')
     await page.click('button')
     await expect(page.locator('.result')).toHaveText('Success')
   })

5. –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò:
   ‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://playwright.dev/docs/intro
   ‚Ä¢ API Reference: https://playwright.dev/docs/api/class-playwright
   ‚Ä¢ –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤: https://playwright.dev/docs/sample-tests
*/



// –≠—Ç–æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª Playwright –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è **end-to-end (E2E) —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –≤–∞—à–µ–≥–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í–æ—Ç —á—Ç–æ –∏–º–µ–Ω–Ω–æ –æ–Ω —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:

// ### üåê **–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç Playwright —Å —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π?**
// 1. **–†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö**:
//    - `Chromium` (–¥–≤–∏–∂–æ–∫ Chrome/Edge)
//    - `Firefox`
//    - `WebKit` (–¥–≤–∏–∂–æ–∫ Safari)
//    *(–º–æ–±–∏–ª—å–Ω—ã–µ –∏ –¥—Ä—É–≥–∏–µ –±—Ä–∞—É–∑–µ—Ä—ã –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã, –Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã)*

// 2. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏**:
//    - –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü (`page.goto()`)
//    - –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
//    - –†–∞–±–æ—Ç–∞ —Å —Ñ–æ—Ä–º–∞–º–∏ (–≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞, –∫–ª–∏–∫–∏)
//    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü (`expect().toHaveText()`)
//    - –°–æ—Å—Ç–æ—è–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–≤–∏–¥–∏–º–æ—Å—Ç—å, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)

// 3. **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**:
//    - –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –Ω–∞ **–≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ** (`npm run dev` –Ω–∞ –ø–æ—Ä—Ç—É 5173)
//    - –ù–∞ CI (GitHub Actions –∏ —Ç.–¥.) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–±–æ—Ä–∫—É** (`npm run preview` –Ω–∞ –ø–æ—Ä—Ç—É 4173)
//    - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –∫–∞–∫ –≤ **headless-—Ä–µ–∂–∏–º–µ** (–±–µ–∑ GUI, –Ω–∞ CI), —Ç–∞–∫ –∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –±—Ä–∞—É–∑–µ—Ä–æ–º (–ª–æ–∫–∞–ª—å–Ω–æ)

// ### üîç **–ì–¥–µ –∏—Å–∫–∞—Ç—å —Å–∞–º–∏ —Ç–µ—Å—Ç—ã?**
// –¢–µ—Å—Ç—ã –ª–µ–∂–∞—Ç –≤ –ø–∞–ø–∫–µ `./e2e` (—É–∫–∞–∑–∞–Ω–æ –≤ `testDir`). –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
// ```
// e2e/
//   ‚îú‚îÄ‚îÄ auth.spec.ts  # –¢–µ—Å—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
//   ‚îú‚îÄ‚îÄ cart.spec.ts  # –¢–µ—Å—Ç—ã –∫–æ—Ä–∑–∏–Ω—ã
//   ‚îî‚îÄ‚îÄ home.spec.ts  # –¢–µ—Å—Ç—ã –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
// ```

// ### üõ† **–ö–∞–∫ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ?**
// 1. **–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–∞—à —Å–µ—Ä–≤–µ—Ä** (Vite/Vue-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
// 2. **Playwright –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä—ã** –∏ –∏–º–∏—Ç–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
//    ```ts
//    await page.goto('/login')  // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
//    await page.fill('#email', 'test@test.com')  // –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
//    await page.click('button[type="submit"]')  // –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ
//    await expect(page).toHaveURL('/dashboard')  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞
//    ```
// 3. **–§–∏–∫—Å–∏—Ä—É—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**:
//    - HTML-–æ—Ç—á—ë—Ç (–∏–∑-–∑–∞ `reporter: 'html'`)
//    - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî —Å–∫—Ä–∏–Ω—à–æ—Ç—ã, –≤–∏–¥–µ–æ (–µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å `video: 'on'`)

// ### üö® **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –æ—Å–æ–±—ã–º?**
// - **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ CI/–ª–æ–∫–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É**:
//   ```js
//   baseURL: process.env.CI ? 'http://localhost:4173' : 'http://localhost:5173'
//   ```
// - **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö `test.only` –Ω–∞ CI** (`forbidOnly: !!process.env.CI`)
// - **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ —à–∞–≥–æ–≤ –¥–ª—è –¥–µ–±–∞–≥–∞** (`trace: 'on-first-retry'`)

// ### üìå **–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –¥–ª—è Vue-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
// ```ts
// // e2e/home.spec.ts
// import { test, expect } from '@playwright/test'

// test('–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è', async ({ page }) => {
//   await page.goto('/')
//   await expect(page).toHaveTitle('–ú–æ—ë Vue-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ')
//   await expect(page.locator('h1')).toHaveText('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å')
// })
// ```

// ### üí° **–ö–æ–≥–¥–∞ —ç—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ?**
// - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Ä–æ—É—Ç–∏–Ω–≥–∞ (`vue-router`)
// - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º (–ª–æ–≥–∏–Ω, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
// - –í–∞–ª–∏–¥–∞—Ü–∏—è SSR-–∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
// - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤)

// **–ò—Ç–æ–≥:** –≠—Ç–æ—Ç –∫–æ–Ω—Ñ–∏–≥ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç **—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö**, –∫–∞–∫ —ç—Ç–æ —É–≤–∏–¥–µ–ª –±—ã –∫–æ–Ω–µ—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –í—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `e2e/` –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã.