import{d as q,f as C,m as S,p as M,c as r,o as i,a as o,q as R,n as p,F as a,g as x,j as w,t as d,v as F,e as c}from"./index-CgzCqIdR.js";const U={class:"max-w-4xl mx-auto bg-gray-50 p-6 rounded-lg shadow-lg m-4"},G={class:"flex border-b border-gray-200 mb-6"},$={key:0,class:"space-y-6"},B={class:"space-y-4"},D={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j={class:"flex flex-col text-gray-600"},E=["onUpdate:modelValue","step"],z={class:"mt-4"},H={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3"},J={class:"text-gray-700 text-sm"},K=["onUpdate:modelValue"],Q={class:"space-y-4"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},X={class:"flex flex-col"},Y={class:"font-semibold text-gray-600"},Z={class:"text-xs text-gray-500 mb-2"},k={key:1,class:"space-y-6"},tt={class:"space-y-4"},st={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ot={class:"flex flex-col text-gray-600"},et={class:"font-medium"},rt={class:"text-xs text-gray-500 mb-1"},it=["onUpdate:modelValue","step","min","max"],at={class:"space-y-4"},nt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},lt={class:"font-semibold text-gray-600"},ct={class:"text-xs text-gray-500 mb-2"},mt=q({__name:"Metrics",setup(dt){const u=C("financial"),l=C({revenue:0,cost:0,operationalCost:0,initialInvestment:0,discountRate:.1,periods:1,cashFlows:[0],depreciation:0}),b=C({mrr:0,numberOfCustomers:0,marketingCosts:0,customerLifetime:12,customerAcquisition:0,conversionRate:.05});S(()=>l.value.periods,(n,e)=>{n>(e??0)?l.value.cashFlows=[...l.value.cashFlows,...Array(n-(e??0)).fill(0)]:e!==void 0&&n<e&&(l.value.cashFlows=l.value.cashFlows.slice(0,n))},{immediate:!0});const O=M(()=>{const{revenue:n,cost:e,operationalCost:s,initialInvestment:t,discountRate:m,cashFlows:f,depreciation:_}=l.value,g=n-e,A=g-s,L=f.reduce((h,v,P)=>h+v/Math.pow(1+m,P+1),-t),N=(()=>{let h=-t;for(let v=0;v<f.length;v++)if(h+=f[v],h>=0)return v+1;return null})(),V=e,I=n-e-s+_;return{margin:n?g/n*100:0,operationalMargin:n?(n-s)/n*100:0,profitability:A-t,roi:t?(A-t)/t*100:0,npv:L,paybackPeriod:N,cogs:V,ebitda:I}}),T=M(()=>{const{mrr:n,numberOfCustomers:e,marketingCosts:s,customerLifetime:t,customerAcquisition:m,conversionRate:f}=b.value,_=n*t,g=e>0?s/e:m;return{ltv:_,cac:g,ltvToCacRatio:g>0?(_/g).toFixed(2):"N/A",conversionRatio:(f*100).toFixed(2),monthlyRecurringRevenue:e*n}}),y=n=>n===null?"text-gray-600":n<0?"text-red-600":"text-blue-600";return(n,e)=>(i(),r("div",U,[e[7]||(e[7]=o("h2",{class:"text-2xl font-bold text-center mb-6 text-gray-700"},"Калькулятор бизнес-метрик",-1)),o("div",G,[o("button",{onClick:e[0]||(e[0]=s=>u.value="financial"),class:p([{"border-b-2 border-blue-500 text-blue-600":u.value==="financial","text-gray-500 hover:text-gray-700":u.value!=="financial"},"py-2 px-4 font-medium text-sm focus:outline-none"])}," Финансовые данные ",2),o("button",{onClick:e[1]||(e[1]=s=>u.value="product"),class:p([{"border-b-2 border-blue-500 text-blue-600":u.value==="product","text-gray-500 hover:text-gray-700":u.value!=="product"},"py-2 px-4 font-medium text-sm focus:outline-none"])}," Метрики продукта ",2)]),u.value==="financial"?(i(),r("div",$,[o("div",B,[e[3]||(e[3]=o("h3",{class:"text-lg font-semibold text-gray-700"},"Введите финансовые данные",-1)),o("div",D,[(i(!0),r(a,null,x(Object.keys(l.value).filter(s=>s!=="cashFlows"),s=>(i(),r("div",{key:s},[o("label",j,[o("span",null,d(s==="revenue"?"Выручка":s==="cost"?"Себестоимость (COGS)":s==="operationalCost"?"Операционные затраты":s==="initialInvestment"?"Начальные инвестиции":s==="discountRate"?"Ставка дисконтирования":s==="periods"?"Количество периодов":s==="depreciation"?"Амортизация":s)+":",1),w(o("input",{type:"number","onUpdate:modelValue":t=>l.value[s]=t,class:p(["w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400",l.value[s]<0?"border-red-300 text-red-600":"border-gray-300 text-gray-700"]),step:s==="discountRate"||s==="depreciation"?"0.01":"1"},null,10,E),[[F,l.value[s]]])])]))),128))]),o("div",z,[e[2]||(e[2]=o("h4",{class:"font-semibold text-gray-700 mb-2"},"Денежные потоки по периодам:",-1)),o("div",H,[(i(!0),r(a,null,x(l.value.cashFlows.slice(0,l.value.periods),(s,t)=>(i(),r("div",{key:t,class:"flex flex-col"},[o("label",J,"Период "+d(t+1)+":",1),w(o("input",{type:"number","onUpdate:modelValue":m=>l.value.cashFlows[t]=m,class:p(["p-2 border rounded-lg focus:ring-2 focus:ring-blue-400",l.value.cashFlows[t]<0?"border-red-300 text-red-600":"border-gray-300 text-gray-700"]),step:"1"},null,10,K),[[F,l.value.cashFlows[t]]])]))),128))])])]),o("div",Q,[e[4]||(e[4]=o("h3",{class:"text-lg font-semibold text-gray-700"},"Финансовые показатели",-1)),o("div",W,[(i(!0),r(a,null,x(O.value,(s,t)=>(i(),r("div",{key:t,class:"bg-white p-4 rounded-lg shadow"},[o("div",X,[o("p",Y,d(t==="margin"?"Маржа":t==="operationalMargin"?"Операционная маржа":t==="profitability"?"Чистая прибыль":t==="roi"?"ROI":t==="npv"?"NPV":t==="paybackPeriod"?"Срок окупаемости":t==="cogs"?"COGS":t==="ebitda"?"EBITDA":t)+": ",1),o("p",Z,[t==="margin"?(i(),r(a,{key:0},[c(" Процент прибыли от выручки: (Выручка - COGS) / Выручка × 100% ")],64)):t==="operationalMargin"?(i(),r(a,{key:1},[c(" Прибыльность после операционных затрат: (Выручка - Операционные затраты) / Выручка × 100% ")],64)):t==="profitability"?(i(),r(a,{key:2},[c(" Фактическая прибыль после всех затрат и инвестиций: Чистая прибыль - Инвестиции ")],64)):t==="roi"?(i(),r(a,{key:3},[c(" Возврат на инвестиции: (Чистая прибыль - Инвестиции) / Инвестиции × 100% ")],64)):t==="npv"?(i(),r(a,{key:4},[c(" Чистая приведённая стоимость: показывает прибыльность проекта с учётом стоимости денег во времени ")],64)):t==="paybackPeriod"?(i(),r(a,{key:5},[c(" Время, за которое проект окупит начальные инвестиции (в годах) ")],64)):t==="cogs"?(i(),r(a,{key:6},[c(" Себестоимость проданных товаров (Cost of Goods Sold) ")],64)):t==="ebitda"?(i(),r(a,{key:7},[c(" Прибыль до вычета процентов, налогов и амортизации: Выручка - COGS - Операционные расходы + Амортизация ")],64)):R("",!0)]),o("p",{class:p(["font-bold mt-1",y(s)])},[t==="paybackPeriod"?(i(),r(a,{key:0},[c(d(s!==null?`${s} лет`:"Не окупается"),1)],64)):t==="margin"||t==="operationalMargin"||t==="roi"?(i(),r(a,{key:1},[c(d(s!==null?`${s.toFixed(2)}%`:"N/A"),1)],64)):(i(),r(a,{key:2},[c(d(s!==null?typeof s=="number"?s.toFixed(2):s:"N/A"),1)],64))],2)])]))),128))])])])):R("",!0),u.value==="product"?(i(),r("div",k,[o("div",tt,[e[5]||(e[5]=o("h3",{class:"text-lg font-semibold text-gray-700"},"Введите метрики продукта",-1)),o("div",st,[(i(!0),r(a,null,x(b.value,(s,t)=>(i(),r("div",{key:t,class:"space-y-1"},[o("label",ot,[o("span",et,d(t==="mrr"?"MRR (ежемесячный доход)":t==="numberOfCustomers"?"Количество клиентов":t==="marketingCosts"?"Затраты на маркетинг":t==="customerLifetime"?"Срок жизни клиента (мес.)":t==="customerAcquisition"?"Затраты на привлечение клиента":"Коэффициент конверсии"),1),o("span",rt,d(t==="mrr"?"Средний ежемесячный регулярный доход от подписки":t==="numberOfCustomers"?"Общее количество активных клиентов":t==="marketingCosts"?"Общие расходы на маркетинг за период":t==="customerLifetime"?"Среднее время работы с клиентом (в месяцах)":t==="customerAcquisition"?"Средняя стоимость привлечения одного клиента":"Процент посетителей, становящихся клиентами (от 0 до 1)"),1),w(o("input",{type:"number","onUpdate:modelValue":m=>b.value[t]=m,class:p(["w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400",b.value[t]<0?"border-red-300 text-red-600":"border-gray-300 text-gray-700"]),step:t==="conversionRate"?"0.01":"1",min:t==="conversionRate"?"0":void 0,max:t==="conversionRate"?"1":void 0},null,10,it),[[F,b.value[t]]])])]))),128))])]),o("div",at,[e[6]||(e[6]=o("h3",{class:"text-lg font-semibold text-gray-700"},"Рассчитанные показатели",-1)),o("div",nt,[(i(!0),r(a,null,x(T.value,(s,t)=>(i(),r("div",{key:t,class:"bg-white p-4 rounded-lg shadow"},[o("p",lt,d(t==="ltv"?"LTV (Lifetime Value)":t==="cac"?"CAC (Customer Acquisition Cost)":t==="ltvToCacRatio"?"LTV/CAC":t==="conversionRatio"?"Коэффициент конверсии":"MRR (Monthly Recurring Revenue)"),1),o("p",ct,d(t==="ltv"?"Общая прибыль от клиента за всё время сотрудничества":t==="cac"?"Средние затраты на привлечение одного клиента":t==="ltvToCacRatio"?"Соотношение ценности клиента к затратам на его привлечение":t==="conversionRatio"?"Процент конверсии посетителей в клиентов":"Общий ежемесячный доход от всех клиентов"),1),o("p",{class:p(["font-bold mt-1",typeof s=="number"?y(s):"text-blue-600"])},[t==="ltvToCacRatio"?(i(),r(a,{key:0},[c(d(s),1)],64)):t==="conversionRatio"?(i(),r(a,{key:1},[c(d(s)+"% ",1)],64)):t==="monthlyRecurringRevenue"?(i(),r(a,{key:2},[c(d(s.toFixed(2)),1)],64)):(i(),r(a,{key:3},[c(d(typeof s=="number"?`${s.toFixed(2)} ₽`:s),1)],64))],2)]))),128))])])])):R("",!0)]))}});export{mt as default};
